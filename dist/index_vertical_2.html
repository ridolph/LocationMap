<!DOCTYPE html>
<html lang="zh-cn">
<head>

    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="UTF-8">

    <title>治安-竖版</title>

    <script src="../dep/jquery/2.2.4/jquery.js"></script>
    <script src="./asset/js/locationMap.js"></script>

</head>
<body>

<div class="myWrapper" style="width: 760px; height: 1080px; background: gray;">

    <div style="width: 650px; height: 1920px;"
         data-toggle="LocationMap"
         data-options='{
                "webSocket_url": "ws://localhost:8080/pkui/noauth/websocket/getPosition",
                "webSocket_onOpen": "establishSocketCallback",
                "webSocket_onMessage": "receivedMessageCallback",
                "webSocket_onClose": "closeSocketCallback",
                "webSocket_onError": "socketErrorCallback",
                "personInfoListUrl": "../test/personInfoListData.json",
                "onClickPerson": "clickPersonCallback",
                "resourcesDir": "./asset/",
                "positionConverter": "positionConverter"
             }'

    >
    </div>

</div>

<script>

    // CAD图坐标 转 2D坐标
    function positionConverter ( pos ) {
        var
            cad_x = pos.x,
            cad_y = pos.y,
            x,
            y
        ;

        x = ( cad_x - 962 ) / 26.225806451612904 + 72;
        y = ( cad_y - 714 ) / -26.16446124763705 + 606;

        return {
            x: y,
            y: -(x -1920)
        };
    }

    function receivedMessageCallback(event) {
        window.LocationMap();
    }

    function clickPersonCallback( position ) {
        console.info( position );
    }

    function socketErrorCallback() {

        LocationMap.markPosition( { cmd: 2, id: "56780", x: 24824, y: 8269 } );
        LocationMap.markPosition( { cmd: 2, id: "56781", x: 2940, y: 12564 } );
        LocationMap.markPosition( { cmd: 2, id: "56782", x: 32630, y: 13000 } );
        LocationMap.markPosition( { cmd: 2, id: "56783", x: 33518, y: 2137 } );
    }


</script>

</body>
</html>