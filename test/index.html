<!DOCTYPE html>
<html lang="zh-cn">
<head>

    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="UTF-8">

    <title>青山分局</title>

    <style>
        #container {
            position   : relative;
            margin     : 10px;
            box-shadow : 0 0 10px rgba(0, 0, 0, .5);
        }
    </style>

    <script src="../dep/jquery/2.2.4/jquery.js"></script>
    <script src="../dist/locationMap.js"></script>

</head>
<body>

<div id="container"
     style="width: 760px; height: 1050px;"
     data-websocket-url="ws://localhost:8080/pkui/noauth/websocket/getPosition"
     data-config-options='{
            "personInfoListUrl": "./asset/personInfoListData.json"
         }'
     data-scene-options='{
            "resources": [
                { "name": "ground_light", "url": "asset/images/scene/ground_760x1050_light.png" },
                { "name": "ground_dark", "url": "asset/images/scene/ground_760x1050_dark.png" },
                { "name": "ordinary_man", "url": "asset/images/character/v4/ordinary_man.png" },
                { "name": "ordinary_woman", "url": "asset/images/character/v4/ordinary_woman.png" },
                { "name": "police_man", "url": "asset/images/character/v4/police_man.png" },
                { "name": "police_woman", "url": "asset/images/character/v4/police_woman.png" },
                { "name": "suspect_man", "url": "asset/images/character/v4/suspect_man.png" },
                { "name": "suspect_woman", "url": "asset/images/character/v4/suspect_woman.png" }
            ]
         }'>
</div>

<script>
    +function () {
        let
            jQuery = window.jQuery
        ;

        /** @event click.character 角色被点击事件 */
        jQuery( document ).on( "pku.click.character", function ( event, personInfo ) {
            alert( "【" + personInfo.id + ", " + personInfo.name + "】被点击了！" );
        } );

        jQuery( document ).ready( function () {
            let
                locationMap,
                sceneOptions,
                configOptions,
                $target

            ;

            $target = jQuery( "#container" );

            sceneOptions = $target.data( "sceneOptions" );
            sceneOptions.targetId = $target.get( 0 ).id;

            configOptions = $target.data( "configOptions" );

            websocketUrl = $target.data( "websocketUrl" );


            locationMap = new window.LocationMap( sceneOptions );

            locationMap.init( function () {

                LocationMap.Config.init( configOptions, function () {

                    locationMap.setCharacter( { cmd: 2, id: "56780", x: 336274/10, y: -331342/10 } );
                    locationMap.setCharacter( { cmd: 2, id: "56782", x: 340274/10, y: -331342/10 } );
                    locationMap.setCharacter( { cmd: 2, id: "56786", x: 344274/10, y: -331342/10 } );
                    locationMap.setCharacter( { cmd: 2, id: "56781", x: 336274/10, y: -335342/10 } );
                    locationMap.setCharacter( { cmd: 2, id: "56783", x: 340274/10, y: -335342/10 } );
                    locationMap.setCharacter( { cmd: 2, id: "56787", x: 344274/10, y: -335342/10 } );

                } );


            } );

            window.locationMap = locationMap;
        } );

    }();
</script>

</body>
</html>